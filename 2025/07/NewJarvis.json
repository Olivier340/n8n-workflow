{"createdAt":"2025-07-26T06:03:15.011Z","updatedAt":"2025-07-28T07:48:37.459Z","id":"4WThmyboYzgncllF","name":"NewJarvis","active":false,"isArchived":false,"nodes":[{"parameters":{"updates":["message"],"additionalFields":{}},"id":"7b67e41b-3a13-4ace-aabc-a06db6814dbf","name":"Telegram Trigger","type":"n8n-nodes-base.telegramTrigger","typeVersion":1.1,"position":[720,-160],"webhookId":"99eab1a0-569d-4f0f-a49e-578a02abfe63","credentials":{"telegramApi":{"id":"9aWKzSaGcHyxa8yE","name":"n8n_oga_bot"}}},{"parameters":{"assignments":{"assignments":[{"id":"fe7ecc99-e1e8-4a5e-bdd6-6fce9757b234","name":"text","value":"={{ $json.message.text }}","type":"string"}]},"options":{}},"id":"cb9b5a65-91b0-48cd-97a7-1040481393f9","name":"Set 'Text'","type":"n8n-nodes-base.set","typeVersion":3.4,"position":[1104,-144]},{"parameters":{"resource":"file","fileId":"={{ $json.message.voice.file_id }}"},"id":"c215b1e2-3df4-444a-9a12-102dc6a030a6","name":"Download Voice File","type":"n8n-nodes-base.telegram","typeVersion":1.2,"position":[1040,-320],"webhookId":"c0b376b1-7b63-41b6-8063-0b3096b8333d","credentials":{"telegramApi":{"id":"9aWKzSaGcHyxa8yE","name":"n8n_oga_bot"}}},{"parameters":{"resource":"audio","operation":"transcribe","options":{}},"id":"e8821014-9c85-4dbf-9c14-a22dcb685a49","name":"Transcribe Audio","type":"@n8n/n8n-nodes-langchain.openAi","typeVersion":1.6,"position":[1200,-320],"credentials":{"openAiApi":{"id":"d4zSwzevlcDFPS3v","name":"OpenAi account"}}},{"parameters":{"rules":{"values":[{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"leftValue":"={{ $json.message.voice.file_id }}","rightValue":"","operator":{"type":"string","operation":"exists","singleValue":true}}],"combinator":"and"},"renameOutput":true,"outputKey":"Voice"},{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"8c844924-b2ed-48b0-935c-c66a8fd0c778","leftValue":"={{ $json.message.text }}","rightValue":"","operator":{"type":"string","operation":"exists","singleValue":true}}],"combinator":"and"},"renameOutput":true,"outputKey":"Text"}]},"options":{}},"id":"cf303b06-76d9-4259-8cec-123b1022a937","name":"Switch","type":"n8n-nodes-base.switch","typeVersion":3.2,"position":[864,-160]},{"parameters":{"promptType":"define","text":"={{ $json.input }}","options":{"systemMessage":"=# Overview\nYou are the ultimate personal assistant. Your job is to send the user's query to the correct tool. You should never be writing emails or creating summaries — your sole responsibility is to call the correct tool.\n\n## Tools\n- **Think**: Use this to think deeply or if you get stuck\n- **emailAgent**: Use this tool to take action in email\n- **calendarAgent**: Use this tool to take action in calendar\n- **contactAgent**: Use this tool to get, update, or add contacts\n- **contentCreator**: Use this tool to create blog posts\n- **webAgent**: Use this tool to perform deeper web research or get current weather info\n- **youtubeAgent**: Use this tool to find high-performing videos or manage video ideas\n\n## Rules\n- Some actions require you to look up contact information first. For the following actions, you must get contact information and send that to the agent who needs it:\n  - sending emails\n  - drafting emails\n  - creating calendar event with attendee\n\n## Instructions\n1) Call the necessary tools based on the user's request\n2) Use the **Think** tool to verify you took the right steps. This tool should be called every time.\n\n## Examples\n1) \n- Input: send an email to nate herkelman asking him what time he wants to leave  \n  - Action: Use **contactAgent** to get Olivier GANDAIS's email  \n  - Action: Use **emailAgent** to send the email. You will pass the tool a query like:  \n    \"send Olivier GANDAIS an email to ask what time he wants to leave. here is his email: [email address]\"\n- Output: The email has been sent to Olivier GANDAIS. Anything else I can help you with?\n\n## Final Reminders\nHere is the current date/time: {{ $now }}\n","returnIntermediateSteps":true}},"type":"@n8n/n8n-nodes-langchain.agent","typeVersion":2.1,"position":[1536,-160],"id":"5459670a-2130-4302-b864-bb98ed67feed","name":"AI Agent","onError":"continueErrorOutput"},{"parameters":{"sendTo":"={{ $fromAI(\"emailAddress\") }}","subject":"={{ $fromAI(\"subject\") }}","message":"={{ $fromAI(\"emailBody\") }}","options":{"appendAttribution":false}},"type":"n8n-nodes-base.gmailTool","typeVersion":2.1,"position":[768,704],"id":"fcb732ac-4fcb-4250-b9ac-2cd52e4e9fa6","name":"Send Email","webhookId":"86c8c4b1-13bb-4ebe-acb9-30e1d7082d55","credentials":{"gmailOAuth2":{"id":"59cQX0HUU0crTquR","name":"Gmail account"}}},{"parameters":{"operation":"getAll","limit":"={{ $fromAI(\"limit\",\"how many emails the user wants\") }}","simple":false,"filters":{"sender":"={{ $fromAI(\"sender\",\"who the emails are from\") }}"},"options":{}},"type":"n8n-nodes-base.gmailTool","typeVersion":2.1,"position":[384,704],"id":"8cc92653-0acc-4b88-8871-048f5ab8d91e","name":"Get Emails","webhookId":"af4b3298-9037-44b0-aa12-2acbfbb5e66f","credentials":{"gmailOAuth2":{"id":"59cQX0HUU0crTquR","name":"Gmail account"}}},{"parameters":{"resource":"draft","subject":"={{ $fromAI(\"subject\") }}","emailType":"html","message":"={{ $fromAI(\"emailBody\") }}","options":{"threadId":"={{ $fromAI(\"threadID\") }}","sendTo":"={{ $fromAI(\"emailAddress\") }}"}},"type":"n8n-nodes-base.gmailTool","typeVersion":2.1,"position":[768,560],"id":"02ca24ca-8a3f-4360-8325-a6a282c82d79","name":"Create Draft","webhookId":"17016bce-d7d7-428a-a56c-f6ea122db8be","credentials":{"gmailOAuth2":{"id":"59cQX0HUU0crTquR","name":"Gmail account"}}},{"parameters":{"operation":"reply","messageId":"={{ $fromAI(\"ID\",\"the message ID\") }}","message":"={{ $fromAI(\"emailBody\") }}","options":{"appendAttribution":false}},"type":"n8n-nodes-base.gmailTool","typeVersion":2.1,"position":[512,560],"id":"d71803cc-2230-47f4-b7c5-90b88c61711c","name":"Email Reply","webhookId":"114785e6-a859-432b-81b4-c490c1c35b1c","credentials":{"gmailOAuth2":{"id":"59cQX0HUU0crTquR","name":"Gmail account"}}},{"parameters":{"resource":"label","returnAll":true},"type":"n8n-nodes-base.gmailTool","typeVersion":2.1,"position":[512,704],"id":"aa56b0c0-402b-4062-8bbb-0b4e840e89fa","name":"Get Labels","webhookId":"9e08b59e-792d-4566-83f1-9263c9ad86ae","credentials":{"gmailOAuth2":{"id":"59cQX0HUU0crTquR","name":"Gmail account"}}},{"parameters":{"operation":"addLabels","messageId":"={{ $fromAI(\"ID\",\"the ID of the message\") }}","labelIds":"={{ $fromAI(\"labelID\") }}"},"type":"n8n-nodes-base.gmailTool","typeVersion":2.1,"position":[640,560],"id":"f08fe126-22d8-4ba1-9991-992aaa6987af","name":"Label Emails","webhookId":"0e951529-2e6d-40bf-ac40-fc0947e242e2","credentials":{"gmailOAuth2":{"id":"59cQX0HUU0crTquR","name":"Gmail account"}}},{"parameters":{"operation":"markAsUnread","messageId":"={{ $fromAI(\"messageID\") }}"},"type":"n8n-nodes-base.gmailTool","typeVersion":2.1,"position":[640,704],"id":"71663352-e5c2-4376-98e0-bb69f5732741","name":"Mark Unread","webhookId":"a35af9d8-f67d-4ff9-803f-59ec6356e795","credentials":{"gmailOAuth2":{"id":"59cQX0HUU0crTquR","name":"Gmail account"}}},{"parameters":{"toolDescription":"An email agent for all email actions","text":"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Prompt__User_Message_', ``, 'string') }}","options":{"systemMessage":"=# Overview\nYou are an email management assistant. All emails must be formatted professionally in HTML and signed off as \"Olivier.\" \n\n**Email Management Tools**   \n   - Use \"Send Email\" to send emails.  \n   - Use \"Create Draft\" if the user asks for a draft.  \n   - Use \"Get Emails\" to retrieve emails when requested.\n   - Use \"Get Labels\" to retrieve labels.\n   - Use \"Mark Unread\" to mark an email as unread. You must use \"Get Emails\" first so you have the message ID of the email to flag.\n   - Use \"Label Email\" to flag an email. You must use \"Get Emails\" first so you have the message ID of the email to flag. Then you must use \"Get Labels\" so you have the label ID.\n   - Use \"Email Reply\" to reply to an email. You must use \"Get Emails\" first so you have the message ID of the email to reply to.\n\n## Final Notes\n- Here is the current date/time: {{ $now }}"}},"type":"@n8n/n8n-nodes-langchain.agentTool","typeVersion":2.2,"position":[576,384],"id":"06d5231e-5667-46fb-b365-b93e8f18c58f","name":"Email Agent"},{"parameters":{"calendar":{"__rl":true,"value":"olivier.info.dev@gmail.com","mode":"list","cachedResultName":"olivier.info.dev@gmail.com"},"start":"={{ $fromAI(\"eventStart\") }}","end":"={{ $fromAI(\"eventEnd\") }}","additionalFields":{"attendees":["={{ $fromAI(\"eventAttendeeEmail\") }}"],"summary":"={{ $fromAI(\"eventTitle\") }}"}},"type":"n8n-nodes-base.googleCalendarTool","typeVersion":1.3,"position":[1264,704],"id":"8085231a-af99-483d-b890-71a642ab58b8","name":"Create Event with Attendee","credentials":{"googleCalendarOAuth2Api":{"id":"L0OimkxzO6Oz5R72","name":"Google Calendar account"}}},{"parameters":{"calendar":{"__rl":true,"value":"olivier.info.dev@gmail.com","mode":"list","cachedResultName":"olivier.info.dev@gmail.com"},"start":"={{ $fromAI(\"eventStart\") }}","end":"={{ $fromAI(\"eventEnd\") }}","additionalFields":{"attendees":[],"summary":"={{ $fromAI(\"eventTitle\") }}"}},"type":"n8n-nodes-base.googleCalendarTool","typeVersion":1.3,"position":[1008,704],"id":"e8dd50b7-ec2a-4b02-b3b8-68f50bc23186","name":"Create Event","credentials":{"googleCalendarOAuth2Api":{"id":"L0OimkxzO6Oz5R72","name":"Google Calendar account"}}},{"parameters":{"operation":"getAll","calendar":{"__rl":true,"value":"olivier.info.dev@gmail.com","mode":"list","cachedResultName":"olivier.info.dev@gmail.com"},"timeMin":"={{ $fromAI(\"dayBefore\",\"the day before the date the user requested\") }}","timeMax":"={{ $fromAI(\"dayAfter\",\"the day after the date the user requested\") }}","options":{}},"type":"n8n-nodes-base.googleCalendarTool","typeVersion":1.3,"position":[1264,560],"id":"dd1ce7f5-c4dc-4f21-8af7-755ab0be707e","name":"Get Events","credentials":{"googleCalendarOAuth2Api":{"id":"L0OimkxzO6Oz5R72","name":"Google Calendar account"}}},{"parameters":{"operation":"delete","calendar":{"__rl":true,"value":"olivier.info.dev@gmail.com","mode":"list","cachedResultName":"olivier.info.dev@gmail.com"},"eventId":"={{ $fromAI(\"eventID\") }}","options":{}},"type":"n8n-nodes-base.googleCalendarTool","typeVersion":1.3,"position":[1136,560],"id":"05102a8f-632a-4aae-9683-51f9ad51d5f1","name":"Delete Event","credentials":{"googleCalendarOAuth2Api":{"id":"L0OimkxzO6Oz5R72","name":"Google Calendar account"}}},{"parameters":{"operation":"update","calendar":{"__rl":true,"value":"olivier.info.dev@gmail.com","mode":"list","cachedResultName":"olivier.info.dev@gmail.com"},"eventId":"={{ $fromAI(\"eventID\") }}","updateFields":{"end":"={{ $fromAI(\"endTime\") }}","start":"={{ $fromAI(\"startTime\") }}"}},"type":"n8n-nodes-base.googleCalendarTool","typeVersion":1.3,"position":[1136,704],"id":"39a3631a-0a25-48e3-9fed-3ec2f9bf05ee","name":"Update Event","credentials":{"googleCalendarOAuth2Api":{"id":"L0OimkxzO6Oz5R72","name":"Google Calendar account"}}},{"parameters":{"toolDescription":"A calendar agent for all calendar actions","text":"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Prompt__User_Message_', ``, 'string') }}","options":{"systemMessage":"=# Overview\nYou are a calendar assistant. Your responsibilities include creating, getting, and deleting events in the user's calendar.\n\n**Calendar Management Tools**  \n   - Use \"Create Event with Attendee\" when an event includes a participant.  \n   - Use \"Create Event\" for solo events.   \n   - Use \"Get Events\" to fetch calendar schedules when requested.\n   - Use \"Delete Event\" to delete an event. You must use \"Get Events\" first to get the ID of the event to delete.\n   - Use \"Update Event\" to update an event. You must use \"Get Events\" first to get the ID of the event to update.\n\n## Final Notes\nHere is the current date/time: {{ $now }}\nIf a duration for an event isn't specified, assume it will be one hour."}},"type":"@n8n/n8n-nodes-langchain.agentTool","typeVersion":2.2,"position":[1024,384],"id":"678091c3-3fa6-4015-bd03-f68d94d8adc2","name":"Calendar Agent"},{"parameters":{"toolDescription":"Contact agent for all contact actions, like getting contacts","text":"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Prompt__User_Message_', ``, 'string') }}","options":{"systemMessage":"=# Overview\nYou are a contact management assistant. Your responsibilities include looking up contacts, adding new contacts, or updating a contact's information.\n\n**Contact Management**  \n   - Use \"Get Contacts\" to retrieve contact information. \n   - Use \"Add Contact\" to store new contact information\n   - Use \"Update Contact\" to modify existing entries. "}},"type":"@n8n/n8n-nodes-langchain.agentTool","typeVersion":2.2,"position":[2576,384],"id":"ed7c5edb-18e0-40e5-ba52-76b4cbdd51cc","name":"Contact Agent"},{"parameters":{"toolDescription":"A research agent for all research actions","text":"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Prompt__User_Message_', ``, 'string') }}","options":{"systemMessage":"=# Overview\nYou are a web research assistant. Your responsibilities include conducting quick web searches, performing deeper research, and retrieving current weather information. \n\n**Web Search & Research**  \n   - Use **Brave Search** for quick factual lookups, recent news, or verifying specific pieces of information.  \n   - Use **Perplexity** when a question requires deeper research, multiple perspectives, or synthesized answers from various sources.  \n\n**Weather Information**  \n   - Use **Open Weather Map** to retrieve current weather data, including temperature, conditions, and forecasts for a given location.\n\nAlways explain your reasoning briefly when choosing between Tavily and Perplexity. Prioritize clarity, credibility, and helpfulness in your responses.\n"}},"type":"@n8n/n8n-nodes-langchain.agentTool","typeVersion":2.2,"position":[1472,384],"id":"7bfea12b-f39d-4592-9c2b-814ca04081a0","name":"Web Agent"},{"parameters":{"text":"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Prompt__User_Message_', ``, 'string') }}","options":{"systemMessage":"=# Overview\nYou are a YouTube content assistant. Your responsibilities include researching high-performing YouTube videos, retrieving existing video ideas, and adding new content ideas to the video database. Your goal is to support content strategy and ideation with relevant, high-quality inputs.\n\n**Video Idea Management**  \n   - Use **Get Ideas** to retrieve existing YouTube video ideas from the internal database.  \n   - Use **Add Idea** to contribute new video ideas to the database for future content planning.\n\n**Content Research**  \n   - Use **YouTube Videos** to search for high-performing videos on a given topic. Analyze trends, titles, formats, and engagement to inspire new content strategies.\n\nWhen suggesting or adding an idea, be specific, creative, and align your suggestions with proven YouTube best practices.\n"}},"type":"@n8n/n8n-nodes-langchain.agentTool","typeVersion":2.2,"position":[3216,400],"id":"2774bccc-55a4-4dad-8241-2522819577bc","name":"YouTube Agent"},{"parameters":{"options":{}},"type":"@n8n/n8n-nodes-langchain.lmChatOpenRouter","typeVersion":1,"position":[48,384],"id":"0eb0d1f5-1665-4c00-9c99-e120b69343e9","name":"GPT 4.1-mini","credentials":{"openRouterApi":{"id":"mP6to1Hs7rtnpaOF","name":"OpenRouter account"}}},{"parameters":{"options":{}},"type":"@n8n/n8n-nodes-langchain.lmChatOpenRouter","typeVersion":1,"position":[336,560],"id":"5feceeb0-d56b-4241-aa47-1dcaa20e1fbc","name":"GPT 4.1-mini1","credentials":{"openRouterApi":{"id":"mP6to1Hs7rtnpaOF","name":"OpenRouter account"}}},{"parameters":{"options":{}},"type":"@n8n/n8n-nodes-langchain.lmChatOpenRouter","typeVersion":1,"position":[1008,560],"id":"9af0f0b9-8e0e-4293-abb5-9689e75de939","name":"GPT 4.1-mini2","credentials":{"openRouterApi":{"id":"mP6to1Hs7rtnpaOF","name":"OpenRouter account"}}},{"parameters":{"options":{}},"type":"@n8n/n8n-nodes-langchain.lmChatOpenRouter","typeVersion":1,"position":[2528,560],"id":"640c1b1d-124b-4655-9431-26641296b4cd","name":"GPT 4.1-mini3","credentials":{"openRouterApi":{"id":"mP6to1Hs7rtnpaOF","name":"OpenRouter account"}}},{"parameters":{"model":"meta-llama/llama-3.1-405b-instruct:free","options":{}},"type":"@n8n/n8n-nodes-langchain.lmChatOpenRouter","typeVersion":1,"position":[1456,544],"id":"0b86696b-d70a-4246-8301-193e02954fff","name":"GPT 4.1-mini4","credentials":{"openRouterApi":{"id":"mP6to1Hs7rtnpaOF","name":"OpenRouter account"}}},{"parameters":{"options":{}},"type":"@n8n/n8n-nodes-langchain.lmChatOpenRouter","typeVersion":1,"position":[3184,576],"id":"1de37360-638d-43b8-88c7-db28792fcf10","name":"GPT 4.1-mini5","credentials":{"openRouterApi":{"id":"mP6to1Hs7rtnpaOF","name":"OpenRouter account"}}},{"parameters":{"jsCode":"// Initialize the output arrays\nconst steps = [];\nconst tokens = [];\nlet totalTokens = 0; // Changed to track total tokens instead of cost\n\n// Process each item in the input\nfor (const item of $input.all()) {\n  let data = item.json;\n  \n  // Check if the data is an array itself (like your example JSON)\n  if (Array.isArray(data)) {\n    // Process each object in the array\n    for (const obj of data) {\n      // Extract steps information\n      if (obj.intermediateSteps && Array.isArray(obj.intermediateSteps)) {\n        for (const step of obj.intermediateSteps) {\n          if (step.action) {\n            steps.push({\n              tool: step.action.tool,\n              toolInput: step.action.toolInput,\n              observation: step.observation\n            });\n          }\n        }\n      }\n      \n      // Extract token information\n      if (obj.intermediateSteps && Array.isArray(obj.intermediateSteps)) {\n        for (const step of obj.intermediateSteps) {\n          if (step.action && step.action.messageLog && Array.isArray(step.action.messageLog)) {\n            for (const message of step.action.messageLog) {\n              if (message.kwargs && message.kwargs.response_metadata && message.kwargs.response_metadata.usage) {\n                const usage = message.kwargs.response_metadata.usage;\n                tokens.push({\n                  prompt_tokens: usage.prompt_tokens,\n                  completion_tokens: usage.completion_tokens,\n                  total_tokens: usage.total_tokens,\n                  model_name: message.kwargs.response_metadata.model_name\n                });\n                \n                // Add the tokens to our running total\n                if (typeof usage.total_tokens === 'number') {\n                  totalTokens += usage.total_tokens;\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  } else {\n    // If data is not an array, process it as a single object\n    // Extract steps information\n    if (data.intermediateSteps && Array.isArray(data.intermediateSteps)) {\n      for (const step of data.intermediateSteps) {\n        if (step.action) {\n          steps.push({\n            tool: step.action.tool,\n            toolInput: step.action.toolInput,\n            observation: step.observation\n          });\n        }\n      }\n    }\n    \n    // Extract token information\n    if (data.intermediateSteps && Array.isArray(data.intermediateSteps)) {\n      for (const step of data.intermediateSteps) {\n        if (step.action && step.action.messageLog && Array.isArray(step.action.messageLog)) {\n          for (const message of step.action.messageLog) {\n            if (message.kwargs && message.kwargs.response_metadata && message.kwargs.response_metadata.usage) {\n              const usage = message.kwargs.response_metadata.usage;\n              tokens.push({\n                prompt_tokens: usage.prompt_tokens,\n                completion_tokens: usage.completion_tokens,\n                total_tokens: usage.total_tokens,\n                model_name: message.kwargs.response_metadata.model_name\n              });\n              \n              // Add the tokens to our running total\n              if (typeof usage.total_tokens === 'number') {\n                totalTokens += usage.total_tokens;\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}\n\n// Return the processed data with total_tokens included\nreturn [{\n  json: {\n    steps: steps,\n    tokens: tokens,\n    total_tokens: totalTokens\n  }\n}];"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[2000,-304],"id":"dbcd3037-715b-4dff-a60a-62966843e686","name":"Clean Up"},{"parameters":{"operation":"append","documentId":{"__rl":true,"value":"144h5vN3d_SsZMNkZncQAKMrwJ3wkceUEq47dO7FwLyA","mode":"list","cachedResultName":"Agent Logs","cachedResultUrl":"https://docs.google.com/spreadsheets/d/144h5vN3d_SsZMNkZncQAKMrwJ3wkceUEq47dO7FwLyA/edit?usp=drivesdk"},"sheetName":{"__rl":true,"value":"gid=0","mode":"list","cachedResultName":"Sheet1","cachedResultUrl":"https://docs.google.com/spreadsheets/d/144h5vN3d_SsZMNkZncQAKMrwJ3wkceUEq47dO7FwLyA/edit#gid=0"},"columns":{"mappingMode":"defineBelow","value":{"Timestamp":"={{ $now.format('yyyy-MM-dd hh:m a') }}","Workflow":"={{ $workflow.name }}","Input":"={{ $('Input').item.json.input }}","Output":"={{ $('AI Agent').item.json.output }}","Actions":"={{ JSON.stringify($json.steps, null, 2) }}","Tokens":"={{ JSON.stringify($json.tokens, null, 2) }}","Total Tokens":"={{ $json.total_tokens }}"},"matchingColumns":[],"schema":[{"id":"Timestamp","displayName":"Timestamp","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"Workflow","displayName":"Workflow","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"Input","displayName":"Input","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"Output","displayName":"Output","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"Actions","displayName":"Actions","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"Tokens","displayName":"Tokens","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"Total Tokens","displayName":"Total Tokens","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true,"removed":false}],"attemptToConvertTypes":false,"convertFieldsToString":false},"options":{}},"type":"n8n-nodes-base.googleSheets","typeVersion":4.6,"position":[2144,-304],"id":"4cf01fe5-aa2e-4c7d-99f5-d6d1b0fe561d","name":"Append row in sheet","credentials":{"googleSheetsOAuth2Api":{"id":"zdCtsjBLk8S5V1ad","name":"Google Sheets account"}}},{"parameters":{"documentId":{"__rl":true,"value":"15CpqbdciFb023LElHxiDQ-CSfbXg-Gk6g5A7Dl_b8Ls","mode":"list","cachedResultName":"Video Ideas","cachedResultUrl":"https://docs.google.com/spreadsheets/d/15CpqbdciFb023LElHxiDQ-CSfbXg-Gk6g5A7Dl_b8Ls/edit?usp=drivesdk"},"sheetName":{"__rl":true,"value":"gid=0","mode":"list","cachedResultName":"Ideas","cachedResultUrl":"https://docs.google.com/spreadsheets/d/15CpqbdciFb023LElHxiDQ-CSfbXg-Gk6g5A7Dl_b8Ls/edit#gid=0"},"options":{}},"type":"n8n-nodes-base.googleSheetsTool","typeVersion":4.6,"position":[3408,576],"id":"4d1d20d0-407b-449e-8864-d7aadb39b292","name":"Get Ideas","credentials":{"googleSheetsOAuth2Api":{"id":"zdCtsjBLk8S5V1ad","name":"Google Sheets account"}}},{"parameters":{"operation":"append","documentId":{"__rl":true,"value":"15CpqbdciFb023LElHxiDQ-CSfbXg-Gk6g5A7Dl_b8Ls","mode":"list","cachedResultName":"Video Ideas","cachedResultUrl":"https://docs.google.com/spreadsheets/d/15CpqbdciFb023LElHxiDQ-CSfbXg-Gk6g5A7Dl_b8Ls/edit?usp=drivesdk"},"sheetName":{"__rl":true,"value":"gid=0","mode":"list","cachedResultName":"Ideas","cachedResultUrl":"https://docs.google.com/spreadsheets/d/15CpqbdciFb023LElHxiDQ-CSfbXg-Gk6g5A7Dl_b8Ls/edit#gid=0"},"columns":{"mappingMode":"defineBelow","value":{"Idea":"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Idea', `Idea title`, 'string') }}","Description":"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Description', `Idea description`, 'string') }}"},"matchingColumns":[],"schema":[{"id":"Idea","displayName":"Idea","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"Description","displayName":"Description","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true}],"attemptToConvertTypes":false,"convertFieldsToString":false},"options":{}},"type":"n8n-nodes-base.googleSheetsTool","typeVersion":4.6,"position":[3520,576],"id":"b6873304-7bc0-4b5c-bd7d-395c6a5c391e","name":"Add Idea","credentials":{"googleSheetsOAuth2Api":{"id":"zdCtsjBLk8S5V1ad","name":"Google Sheets account"}}},{"parameters":{"toolDescription":"Use this tool to find high-performing YouTube videos","method":"POST","url":"https://api.apify.com/v2/acts/streamers~youtube-scraper/run-sync-get-dataset-items","sendQuery":true,"queryParameters":{"parameters":[{}]},"sendBody":true,"specifyBody":"json","jsonBody":"={\n    \"dateFilter\": \"month\",\n    \"downloadSubtitles\": false,\n    \"hasCC\": false,\n    \"hasLocation\": false,\n    \"hasSubtitles\": false,\n    \"is360\": false,\n    \"is3D\": false,\n    \"is4K\": false,\n    \"isBought\": false,\n    \"isHD\": false,\n    \"isHDR\": false,\n    \"isLive\": false,\n    \"isVR180\": false,\n    \"maxResultStreams\": 0,\n    \"maxResults\": {{$fromAI(\"maxResults\",\"how many videos the user wants, if not specified, default to 3\",\"number\",3)}},\n    \"maxResultsShorts\": 0,\n    \"oldestPostDate\": \"6 months\",\n    \"preferAutoGeneratedSubtitles\": false,\n    \"saveSubsToKVS\": false,\n    \"searchQueries\": [\n        \"{{$fromAI(\"searchTerm\",\"The topic of the video to search for\")}}\"\n    ],\n    \"sortVideosBy\": \"POPULAR\",\n    \"sortingOrder\": \"views\"\n}","options":{}},"type":"n8n-nodes-base.httpRequestTool","typeVersion":4.2,"position":[3296,576],"id":"76d1f739-9997-4384-ac28-98705f098937","name":"YouTube Videos"},{"parameters":{},"type":"@n8n/n8n-nodes-langchain.toolThink","typeVersion":1,"position":[160,384],"id":"2c904e40-74c7-4a8c-9b39-2e7d842a8547","name":"Think"},{"parameters":{"sessionIdType":"customKey","sessionKey":"={{ $('Telegram Trigger').item.json.message.chat.id }}"},"type":"@n8n/n8n-nodes-langchain.memoryBufferWindow","typeVersion":1.3,"position":[304,384],"id":"4e810fcc-2019-40d3-b76b-f34878646515","name":"Simple Memory"},{"parameters":{"chatId":"={{ $('Telegram Trigger').item.json.message.chat.id }}","text":"={{ $json.error }}","additionalFields":{"appendAttribution":false}},"type":"n8n-nodes-base.telegram","typeVersion":1.2,"position":[2000,-144],"id":"003a657c-f05f-4e6e-906f-b0748e4dde4c","name":"Error Message","webhookId":"7065a160-b927-43b6-b327-feec46cc0088","credentials":{"telegramApi":{"id":"9aWKzSaGcHyxa8yE","name":"n8n_oga_bot"}}},{"parameters":{"chatId":"={{ $('Telegram Trigger').item.json.message.chat.id }}","text":"={{ $('AI Agent').item.json.output }}","additionalFields":{"appendAttribution":false}},"type":"n8n-nodes-base.telegram","typeVersion":1.2,"position":[2288,-304],"id":"be9da784-cc48-4f54-8a4a-6a5d87437f9d","name":"Response","webhookId":"4d174459-d5cc-4297-a449-369d3f10ef23","credentials":{"telegramApi":{"id":"9aWKzSaGcHyxa8yE","name":"n8n_oga_bot"}}},{"parameters":{"assignments":{"assignments":[{"id":"976cf2c9-01b6-46cf-97b4-675a67ca57bc","name":"input","value":"={{ $json.text }}","type":"string"}]},"options":{}},"type":"n8n-nodes-base.set","typeVersion":3.4,"position":[1376,-160],"id":"30f35a8d-23a2-422c-b82e-4c1f117912a6","name":"Input"},{"parameters":{"content":"# ⚙️ Setup Guide  \n**Author:** [Nate Herk](https://www.youtube.com/@nateherk)\n\nFollow these steps to get your n8n AI agent workflow fully configured and connected:\n\n### ✅ Step 1: Connect Your Telegram Account  \nUse the **Telegram Trigger** node to link your Telegram account. This allows you to interact with your agent via Telegram. Make sure it's fully connected—it’s used in both the **Telegram Response** nodes and the **Simple Memory** node.\n\n### ✅ Step 2: Add Your [OpenRouter](https://openrouter.ai/) API Key  \nThis is the \"brain\" of your AI agent. Plug in your API key using the **HTTP Request** or **Credential** node to power intelligent responses.\n\n### ✅ Step 3: Connect Your App Integrations  \nSet up the following API connections so your agent can take meaningful actions:\n- **Gmail**\n- **Google Calendar**\n- **Airtable**\n- **Google Sheets**\n- **Apify** – Used in the YouTube video node.  \n  💡 *Use code* **`30NATEHERK`** *for 30% off your first 3 months at [Apify](https://www.apify.com/?fpr=nate)*\n\n### ✅ Step 4: Connect Research & Utility APIs  \nAdd these keys for more powerful features:\n- [**Tavily API Key**](https://www.tavily.com/)\n- [**Perplexity API Key**](https://www.perplexity.ai/)\n- [**Open Weather Map API Key**](https://openweathermap.org/api)\n\n### ✅ Step 5: Link Your Google Sheets Templates  \n- 📄 [Agent Action Log Sheet](https://docs.google.com/spreadsheets/d/1PlRVi9Iv2n11SPYdshjhPGWccRCpKLHn3PjUkJEjgAQ/edit?usp=sharing) – Logs the agent’s actions.\n- 🎬 [YouTube Ideas Sheet](https://docs.google.com/spreadsheets/d/1Jazczp5HtPwcJvu6bmJQrjkqt31S7adVqIFVCqXZwGk/edit?usp=sharing) – Used for the YouTube agent’s video ideas.\n\n### 🚀 Final Step: Start Prompting  \nWith everything connected, start chatting with your agent on Telegram and watch it take intelligent action across your tool stack!\n","height":912,"width":784},"type":"n8n-nodes-base.stickyNote","typeVersion":1,"position":[-1008,-80],"id":"54df68d1-40e5-446d-a6b6-a4d278ee7451","name":"Sticky Note"},{"parameters":{"model":{"__rl":true,"mode":"list","value":"gpt-4o-mini"},"options":{}},"type":"@n8n/n8n-nodes-langchain.lmChatOpenAi","typeVersion":1.2,"position":[2112,560],"id":"d17fa70e-d69a-444c-9ca0-47ea5a625ca0","name":"OpenAI Chat Model","credentials":{"openAiApi":{"id":"d4zSwzevlcDFPS3v","name":"OpenAi account"}}},{"parameters":{"toolDescription":"A content web creator Agent ","text":"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Prompt__User_Message_', ``, 'string') }}","options":{"systemMessage":"# Overview\nYou are a skilled AI blog writer specializing in engaging, well-structured, and informative content. Your writing style is clear, compelling, and tailored to the target audience. You optimize for readability, SEO, and value, ensuring blogs are well-researched, original, and free of fluff.\n\n## Tools\nBrave Search- Use this to search the web about the requested topic for the blog post.\n\n## Blog Requirements\nFormat all blog content in HTML, using proper headings (<h1>, <h2>), paragraphs (<p>), bullet points (<ul><li>), and links (<a href=\"URL\">) for citations. All citations from the Tavily tool must be preserved, with clickable hyperlinks so readers can access the original sources.\n\nMaintain a natural, human-like tone, use varied sentence structures, and include relevant examples or data when needed. Structure content for easy reading with concise paragraphs and logical flow. Always ensure factual accuracy and align the tone with the intended brand or purpose.\""}},"type":"@n8n/n8n-nodes-langchain.agentTool","typeVersion":2.2,"position":[2112,384],"id":"92261ef6-69ea-4616-b786-4a65019b4a8d","name":"Content web Creator"},{"parameters":{"toolDescription":"Use this tool to search the internet","method":"POST","url":"https://api.tavily.com/search","sendBody":true,"specifyBody":"json","jsonBody":"{\n    \"api_key\": \"your-api-key\",\n    \"query\": \"{searchTerm}\",\n    \"search_depth\": \"basic\",\n    \"include_answer\": true,\n    \"topic\": \"news\",\n    \"include_raw_content\": true,\n    \"max_results\": 3\n} ","placeholderDefinitions":{"values":[{"name":"searchTerm","description":"What the user has requested to write a blog about","type":"string"}]}},"type":"@n8n/n8n-nodes-langchain.toolHttpRequest","typeVersion":1.1,"position":[1600,544],"id":"a5cc8cf0-6a51-466c-82f7-7b5d7369ae97","name":"Tavily"},{"parameters":{"operation":"getAll","returnAll":"={{ $fromAI('Return_All', ``, 'boolean') }}","useQuery":"={{ $fromAI('Use_Query', ``, 'boolean') }}","rawData":"={{ $fromAI('RAW_Data', ``, 'boolean') }}","options":{}},"type":"n8n-nodes-base.googleContactsTool","typeVersion":1,"position":[2704,592],"id":"b0e4c3fc-a1a9-4aa5-af8e-6440244bd527","name":"Get a contacts","credentials":{"googleContactsOAuth2Api":{"id":"GCMKSD5pKNlhQEyI","name":"Google Contacts account"}}},{"parameters":{"familyName":"={{ $fromAI('Family_Name', ``, 'string') }}","givenName":"={{ $fromAI('Given_Name', ``, 'string') }}","additionalFields":{"emailsUi":{"emailsValues":[{"type":"work","value":"={{ $fromAI('emailsValues0_Value', ``, 'string') }}"}]},"phoneUi":{"phoneValues":[{"type":"work","value":"={{ $fromAI('phoneValues0_Value', ``, 'string') }}"}]}}},"type":"n8n-nodes-base.googleContactsTool","typeVersion":1,"position":[2832,592],"id":"eb5637d7-c1bc-4d94-8e35-f86aec4842af","name":"Create a contact","credentials":{"googleContactsOAuth2Api":{"id":"GCMKSD5pKNlhQEyI","name":"Google Contacts account"}}},{"parameters":{"operation":"update","contactId":"={{ $fromAI('Contact_ID', ``, 'string') }}","fields":"={{ $fromAI('Fields', ``, 'string') }}","updateFields":{"emailsUi":{"emailsValues":[{"type":"work","value":"={{ $fromAI('emailsValues0_Value', ``, 'string') }}"}]},"phoneUi":{"phoneValues":[{"type":"work","value":"={{ $fromAI('phoneValues0_Value', ``, 'string') }}"}]}}},"type":"n8n-nodes-base.googleContactsTool","typeVersion":1,"position":[2976,592],"id":"ca1ca7d0-f664-4c70-9e18-f369a8700928","name":"Update Contact","credentials":{"googleContactsOAuth2Api":{"id":"GCMKSD5pKNlhQEyI","name":"Google Contacts account"}}},{"parameters":{"query":"={{ $fromAI('Query', ``, 'string') }}"},"type":"@brave/n8n-nodes-brave-search.braveSearchTool","typeVersion":1,"position":[1856,544],"id":"dbf21713-d038-4059-aa0f-b75edf821a54","name":"Brave Search","credentials":{"braveSearchApi":{"id":"xFnSpyWMMmAaKHI5","name":"Brave Search account"}}}],"connections":{"Telegram Trigger":{"main":[[{"node":"Switch","type":"main","index":0}]]},"Download Voice File":{"main":[[{"node":"Transcribe Audio","type":"main","index":0}]]},"Switch":{"main":[[{"node":"Download Voice File","type":"main","index":0}],[{"node":"Set 'Text'","type":"main","index":0}]]},"Set 'Text'":{"main":[[{"node":"Input","type":"main","index":0}]]},"Transcribe Audio":{"main":[[{"node":"Input","type":"main","index":0}]]},"Send Email":{"ai_tool":[[{"node":"Email Agent","type":"ai_tool","index":0}]]},"Get Emails":{"ai_tool":[[{"node":"Email Agent","type":"ai_tool","index":0}]]},"Create Draft":{"ai_tool":[[{"node":"Email Agent","type":"ai_tool","index":0}]]},"Email Reply":{"ai_tool":[[{"node":"Email Agent","type":"ai_tool","index":0}]]},"Get Labels":{"ai_tool":[[{"node":"Email Agent","type":"ai_tool","index":0}]]},"Label Emails":{"ai_tool":[[{"node":"Email Agent","type":"ai_tool","index":0}]]},"Mark Unread":{"ai_tool":[[{"node":"Email Agent","type":"ai_tool","index":0}]]},"Email Agent":{"ai_tool":[[{"node":"AI Agent","type":"ai_tool","index":0}]]},"Create Event with Attendee":{"ai_tool":[[{"node":"Calendar Agent","type":"ai_tool","index":0}]]},"Create Event":{"ai_tool":[[{"node":"Calendar Agent","type":"ai_tool","index":0}]]},"Get Events":{"ai_tool":[[{"node":"Calendar Agent","type":"ai_tool","index":0}]]},"Delete Event":{"ai_tool":[[{"node":"Calendar Agent","type":"ai_tool","index":0}]]},"Update Event":{"ai_tool":[[{"node":"Calendar Agent","type":"ai_tool","index":0}]]},"Calendar Agent":{"ai_tool":[[{"node":"AI Agent","type":"ai_tool","index":0}]]},"Contact Agent":{"ai_tool":[[{"node":"AI Agent","type":"ai_tool","index":0}]]},"Web Agent":{"ai_tool":[[{"node":"AI Agent","type":"ai_tool","index":0}]]},"YouTube Agent":{"ai_tool":[[{"node":"AI Agent","type":"ai_tool","index":0}]]},"GPT 4.1-mini":{"ai_languageModel":[[{"node":"AI Agent","type":"ai_languageModel","index":0}]]},"GPT 4.1-mini1":{"ai_languageModel":[[{"node":"Email Agent","type":"ai_languageModel","index":0}]]},"GPT 4.1-mini2":{"ai_languageModel":[[{"node":"Calendar Agent","type":"ai_languageModel","index":0}]]},"GPT 4.1-mini3":{"ai_languageModel":[[{"node":"Contact Agent","type":"ai_languageModel","index":0}]]},"GPT 4.1-mini4":{"ai_languageModel":[[{"node":"Web Agent","type":"ai_languageModel","index":0}]]},"GPT 4.1-mini5":{"ai_languageModel":[[{"node":"YouTube Agent","type":"ai_languageModel","index":0}]]},"AI Agent":{"main":[[{"node":"Clean Up","type":"main","index":0}],[{"node":"Error Message","type":"main","index":0}]]},"Clean Up":{"main":[[{"node":"Append row in sheet","type":"main","index":0}]]},"Append row in sheet":{"main":[[{"node":"Response","type":"main","index":0}]]},"Get Ideas":{"ai_tool":[[{"node":"YouTube Agent","type":"ai_tool","index":0}]]},"Add Idea":{"ai_tool":[[{"node":"YouTube Agent","type":"ai_tool","index":0}]]},"YouTube Videos":{"ai_tool":[[{"node":"YouTube Agent","type":"ai_tool","index":0}]]},"Think":{"ai_tool":[[{"node":"AI Agent","type":"ai_tool","index":0}]]},"Simple Memory":{"ai_memory":[[{"node":"AI Agent","type":"ai_memory","index":0}]]},"Input":{"main":[[{"node":"AI Agent","type":"main","index":0}]]},"OpenAI Chat Model":{"ai_languageModel":[[{"node":"Content web Creator","type":"ai_languageModel","index":0}]]},"Tavily":{"ai_tool":[[{"node":"Web Agent","type":"ai_tool","index":0}]]},"Content web Creator":{"ai_tool":[[{"node":"AI Agent","type":"ai_tool","index":0}]]},"Get a contacts":{"ai_tool":[[{"node":"Contact Agent","type":"ai_tool","index":0}]]},"Create a contact":{"ai_tool":[[{"node":"Contact Agent","type":"ai_tool","index":0}]]},"Update Contact":{"ai_tool":[[{"node":"Contact Agent","type":"ai_tool","index":0}]]},"Brave Search":{"ai_tool":[[{"node":"Content web Creator","type":"ai_tool","index":0},{"node":"Web Agent","type":"ai_tool","index":0}]]}},"settings":{"executionOrder":"v1"},"staticData":null,"meta":{"templateCredsSetupCompleted":true},"pinData":{},"versionId":"9d0a72a2-c526-46c3-bf75-6962bd6bc4ee","triggerCount":1,"tags":[],"repo_owner":"Olivier340","repo_name":"n8n-workflow","repo_path":"","subPath":"2025/07/"}